? schemaUpdate.patch
Index: DatabaseMetadata.java
===================================================================
RCS file: /cvsroot/hibernate/Hibernate2/src/net/sf/hibernate/tool/hbm2ddl/DatabaseMetadata.java,v
retrieving revision 1.1
diff -r1.1 DatabaseMetadata.java
29c29
< 		initSequences(connection, dialect);
---
> 		initSequences(meta);
44,45c44
< 						rs = meta.getTables(null, "%", name.toUpperCase(), types);
< 				
---
> 						rs = meta.getTables(null, "%", "%", types);
67,72c66
< 	private void initSequences(Connection connection, Dialect dialect) throws SQLException {
< 		String sql = dialect.getQuerySequencesString();
< 		
< 		if (sql==null) return;
< 		
< 		Statement statement = null;
---
> 	private void initSequences(DatabaseMetaData meta) throws SQLException {
75,76c69,70
< 			statement = connection.createStatement();
< 			rs = statement.executeQuery(sql);
---
>         String[] types = {"SEQUENCE"};
>         rs = meta.getTables(null, "%", "%", types);
78c72
< 			while ( rs.next() ) sequences.add( rs.getString(1).toUpperCase() );
---
>         while ( rs.next() ) sequences.add( rs.getString("TABLE_NAME").toUpperCase() );
82d75
< 			if (statement!=null) statement.close();
Index: ForeignKeyMetadata.java
===================================================================
RCS file: /cvsroot/hibernate/Hibernate2/src/net/sf/hibernate/tool/hbm2ddl/ForeignKeyMetadata.java,v
retrieving revision 1.1
diff -r1.1 ForeignKeyMetadata.java
18c18,23
< 		name = rs.getString("FK_NAME");
---
> 		String temp = rs.getString("FK_NAME");
>     if (temp.indexOf("\\") > 0) {
>         name = temp.substring(0, temp.indexOf("\\"));
>     } else {
>         name = temp;
>     }
