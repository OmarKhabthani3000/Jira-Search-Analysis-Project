7c7,13
< import java.util.StringTokenizer;
---
> import org.apache.oro.text.regex.Pattern;
> import org.apache.oro.text.regex.Perl5Compiler;
> import org.apache.oro.text.regex.PatternMatcher;
> import org.apache.oro.text.regex.Perl5Matcher;
> import org.apache.oro.text.regex.PatternMatcherInput;
> import org.apache.oro.text.regex.MatchResult;
> import org.apache.oro.text.regex.MalformedPatternException;
49,57c55,64
< 		if (propValue!=null) {
< 			StringTokenizer tokens = new StringTokenizer(propValue, delim);
< 			while ( tokens.hasMoreTokens() ) {
< 				map.put(
< 					tokens.nextToken(),
< 					tokens.hasMoreElements() ? tokens.nextToken() : StringHelper.EMPTY_STRING
< 				);
< 			}
< 		}
---
>                 try {
>                     Pattern pattern = new Perl5Compiler().compile("(?:^|[,;:])\\s*(\\w+)(?:\\s*=\\s*|\\s+)('(?:[^']|'')*'|\\w+)", 1);
>                     PatternMatcher matcher = new Perl5Matcher();
>                     PatternMatcherInput input = new PatternMatcherInput(propValue);
>                     while (matcher.contains(input, pattern)) {
>                         MatchResult result = matcher.getMatch();
>                         map.put(result.group(1), result.group(2));
>                     }
>                 } catch (MalformedPatternException ex) {
>                 }
