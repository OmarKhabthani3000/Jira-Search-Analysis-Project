<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping
        SYSTEM "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd">

<hibernate-mapping>
    <class name="com.enterra.surv.po.Survey" table="t_survey" proxy="com.enterra.surv.po.Survey">
        <cache usage="read-write"/>

        <id name="id" column="f_survey_id" type="int" unsaved-value="0">
            <generator class="com.enterra.surv.system.IdGenerator"/>
        </id>

        <many-to-one name="owner" class="com.enterra.surv.po.User" column="f_owner" not-null="true"/>

        <many-to-one name="style" class="com.enterra.surv.po.Style" column="f_style_id" not-null="false" />

        <property name="name" type="java.lang.String" column="f_name" not-null="true"/>

        <property name="description" type="java.lang.String" column="f_description" not-null="false"/>

        <property name="state" type="com.enterra.surv.po.enum.SurveyState" column="f_state" not-null="true"/>

        <property name="type" type="com.enterra.surv.po.enum.SurveyType" column="f_type" not-null="true"/>

        <property name="showWelcomePage" type="boolean" column="f_show_welcome_page"/>

        <property name="showFinishPage" type="boolean" column="f_show_finish_page"/>

        <property name="allowBackNavigation" type="boolean" column="f_allow_back_navigation"/>

        <property name="library" type="boolean" column="f_is_library"/>

        <property name="launchMoment" type="java.sql.Timestamp" column="f_launch_moment"/>

        <property name="finishMoment" type="java.sql.Timestamp" column="f_finish_moment"/>

        <property name="created" type="java.sql.Timestamp" column="f_created"/>

        <property name="modified" type="java.sql.Timestamp" column="f_modified"/>

        <property name="archived" type="boolean" column="f_archived"/>

        <property name="enableIPProtection" type="boolean" column="f_enable_ip_protection"/>
        <property name="enableCookieProtection" type="boolean" column="f_enable_cookie_protection"/>
        <property name="enableAuthProtection" type="boolean" column="f_enable_auth_protection"/>
        <property name="enableTimeProtection" type="boolean" column="f_enable_time_protection"/>
        <property name="protectionType" type="com.enterra.surv.po.enum.ProtectionType" column="f_protection_type" not-null="true"/>

        <bag name="pages" cascade="all" inverse="true" lazy="true" table="t_page" order-by="f_order" where="f_archived=0">
            <cache usage="read-write"/>
            <key column="f_survey_id"/>
            <one-to-many class="com.enterra.surv.po.Page"/>
        </bag>

        <bag name="interviews" cascade="all" inverse="true" lazy="true" table="t_interview" where="f_archived=0">
            <cache usage="read-write"/>
            <key column="f_survey_id"/>
            <one-to-many class="com.enterra.surv.po.Interview"/>
        </bag>

        <bag name="reports" cascade="all" inverse="true" lazy="true" table="t_report" where="f_archived=0">
            <cache usage="read-write"/>
            <key column="f_survey_id"/>
            <one-to-many class="com.enterra.surv.po.Report"/>
        </bag>

        <bag name="invitees" lazy="true" table="t_invitation">
            <cache usage="read-write"/>
            <key column="f_user_id"/>
            <many-to-many class="com.enterra.surv.po.User" column="f_survey_id"/>
        </bag>

        <map name="titleResources" lazy="true" table="t_resource" cascade="all" where="f_class=1">
            <cache usage="read-write"/>
            <key column="f_owner_id"/>
            <index column="f_language" type="com.enterra.surv.po.enum.Language"/>
            <one-to-many class="com.enterra.surv.po.Resource"/>
        </map>

        <map name="welcomeTextResources" lazy="true" table="t_resource" cascade="all" where="f_class=2">
            <cache usage="read-write"/>
            <key column="f_owner_id"/>
            <index column="f_language" type="com.enterra.surv.po.enum.Language"/>
            <one-to-many class="com.enterra.surv.po.Resource"/>
        </map>

        <map name="thankYouTextResources" lazy="true" table="t_resource" cascade="all" where="f_class=6">
            <jcs-cache usage="read-write"/>
            <key column="f_owner_id"/>
            <index column="f_language" type="com.enterra.surv.po.enum.Language"/>
            <one-to-many class="com.enterra.surv.po.Resource"/>
        </map>

    </class>
</hibernate-mapping>

