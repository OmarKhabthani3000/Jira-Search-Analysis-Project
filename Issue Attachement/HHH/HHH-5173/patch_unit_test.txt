### Eclipse Workspace Patch 1.0
#P hibernate-testsuite
Index: src/test/java/org/hibernate/test/hql/ASTParserLoadingTest.java
===================================================================
--- src/test/java/org/hibernate/test/hql/ASTParserLoadingTest.java	(revision 19326)
+++ src/test/java/org/hibernate/test/hql/ASTParserLoadingTest.java	(working copy)
@@ -1580,7 +1580,36 @@
 		assertEquals(sum.floatValue(), 74.0, 0.01);
 		assertEquals(avg.doubleValue(), 120.5, 0.01);
 		Long id = (Long) s.createQuery("select max(a.id) from Animal a").uniqueResult();
-		s.delete(h);
+		assertNotNull(id);
+		
+		//initialize humans 
+		s.createQuery( "delete Human" ).executeUpdate();		
+		Human a1 = new  Human();
+		a1.setFloatValue(2.5F);	
+		a1.setIntValue(1);
+		s.save(a1);
+		Human a2 = new  Human();
+		a2.setFloatValue(2.5F);		
+		a2.setIntValue(2);
+		s.save(a2);
+		
+		//check sum and avg
+		Query query = s.createQuery( "select sum(h.floatValue), avg(h.floatValue), sum(h.intValue), avg(h.intValue) from Human h" );
+		Object[] result = (Object[]) query.uniqueResult();
+		//--- floats
+		//sum works with floats
+		assertEquals("Invalid sum", 5D, result[0]);
+		//average works with floats
+		assertEquals("Invalid avg", 2.5D, result[1]);
+		//--- longs
+		//sum works with longs
+		assertEquals("Invalid sum", 3L, result[2]);
+		//average works with longs
+		assertEquals("Invalid avg", 1.5D, result[3]);						
+
+		s.delete(a1);
+		s.delete(a2);
+		
 		t.commit();
 		s.close();
 	}
