Index: ProxyTest.java
===================================================================
RCS file: /cvsroot/hibernate/Hibernate3/test/org/hibernate/test/proxy/ProxyTest.java,v
retrieving revision 1.8
diff -u -r1.8 ProxyTest.java
--- ProxyTest.java	30 Aug 2005 03:03:17 -0000	1.8
+++ ProxyTest.java	27 Oct 2005 07:11:36 -0000
@@ -2,6 +2,7 @@
 package org.hibernate.test.proxy;
 
 import java.math.BigDecimal;
+import java.util.Arrays;
 
 import junit.framework.Test;
 import junit.framework.TestSuite;
@@ -23,6 +24,40 @@
 		super(str);
 	}
 	
+	
+	
+	public void testFInalizeFiltered(){
+		
+		Session s = openSession();
+		Transaction t = s.beginTransaction();
+		DataPoint dp = new DataPoint();
+		dp.setDescription("a data point");
+		dp.setX( new BigDecimal(1.0) );
+		dp.setY( new BigDecimal(2.0) );
+		s.persist(dp);
+		s.flush();
+		s.clear();
+		
+		dp = (DataPoint) s.load(DataPoint.class, new Long( dp.getId() ) );
+		assertFalse( Hibernate.isInitialized(dp) );
+		 
+		
+		try {
+			
+			dp.getClass().getDeclaredMethod("finalize",new Class[]{});
+			fail();
+			
+		} catch (NoSuchMethodException e) {
+			
+		}
+		
+		s.delete(dp);
+		t.commit();
+		s.close();
+		
+		
+	}
+	
 	public void testProxyException() {
 		Session s = openSession();
 		Transaction t = s.beginTransaction();
@@ -36,6 +71,9 @@
 		
 		dp = (DataPoint) s.load(DataPoint.class, new Long( dp.getId() ) );
 		assertFalse( Hibernate.isInitialized(dp) );
+		 
+		
+		
 		try {
 			dp.exception();
 			fail();
