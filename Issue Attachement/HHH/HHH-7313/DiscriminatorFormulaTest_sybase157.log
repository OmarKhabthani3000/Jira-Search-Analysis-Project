Error Message

javax.persistence.RollbackException: Error while committing the transaction

Stacktrace

javax.persistence.RollbackException: Error while committing the transaction
	at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:92)
	at org.hibernate.envers.test.integration.inheritance.single.discriminatorformula.DiscriminatorFormulaTest.initData(DiscriminatorFormulaTest.java:75)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.hibernate.testing.junit4.ExtendedFrameworkMethod.invokeExplosively(ExtendedFrameworkMethod.java:63)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.hibernate.testing.junit4.FailureExpectedHandler.evaluate(FailureExpectedHandler.java:58)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.hibernate.testing.junit4.BeforeClassCallbackHandler.evaluate(BeforeClassCallbackHandler.java:43)
	at org.hibernate.testing.junit4.AfterClassCallbackHandler.evaluate(AfterClassCallbackHandler.java:42)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:24)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:51)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:63)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:49)
	at sun.reflect.GeneratedMethodAccessor39.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:75)
	at $Proxy3.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:91)
	at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.TypeCastDispatch.dispatch(TypeCastDispatch.java:30)
	at org.gradle.messaging.remote.internal.WorkerProtocol.handleIncoming(WorkerProtocol.java:53)
	at org.gradle.messaging.remote.internal.WorkerProtocol.handleIncoming(WorkerProtocol.java:31)
	at org.gradle.messaging.remote.internal.ProtocolStack$ProtocolStage.handleIncoming(ProtocolStack.java:167)
	at org.gradle.messaging.remote.internal.ProtocolStack$BottomStage.handleIncoming(ProtocolStack.java:277)
	at org.gradle.messaging.remote.internal.ProtocolStack$BottomConnection$1.run(ProtocolStack.java:299)
	at org.gradle.messaging.remote.internal.ProtocolStack$ExecuteRunnable.dispatch(ProtocolStack.java:120)
	at org.gradle.messaging.remote.internal.ProtocolStack$ExecuteRunnable.dispatch(ProtocolStack.java:116)
	at org.gradle.messaging.dispatch.AsyncDispatch.dispatchMessages(AsyncDispatch.java:132)
	at org.gradle.messaging.dispatch.AsyncDispatch.access$000(AsyncDispatch.java:33)
	at org.gradle.messaging.dispatch.AsyncDispatch$1.run(AsyncDispatch.java:72)
	at org.gradle.messaging.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:66)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
Caused by: javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: A SELECT FOR UPDATE query cannot be used with DISTINCT, GROUP BY, HAVING, COMPUTE, UNION, aggregates, computed columns, subqueries or SELECT INTO.

	at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1372)
	at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1295)
	at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:80)
	... 63 more
Caused by: org.hibernate.exception.GenericJDBCException: A SELECT FOR UPDATE query cannot be used with DISTINCT, GROUP BY, HAVING, COMPUTE, UNION, aggregates, computed columns, subqueries or SELECT INTO.

	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:54)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:125)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:110)
	at org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:129)
	at org.hibernate.engine.jdbc.internal.proxy.AbstractProxyHandler.invoke(AbstractProxyHandler.java:81)
	at $Proxy22.executeQuery(Unknown Source)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:1953)
	at org.hibernate.loader.Loader.doQuery(Loader.java:829)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:289)
	at org.hibernate.loader.Loader.doList(Loader.java:2438)
	at org.hibernate.loader.Loader.doList(Loader.java:2424)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2254)
	at org.hibernate.loader.Loader.list(Loader.java:2249)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:470)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:355)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:195)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1248)
	at org.hibernate.internal.QueryImpl.list(QueryImpl.java:101)
	at org.hibernate.envers.strategy.ValidityAuditStrategy.perform(ValidityAuditStrategy.java:80)
	at org.hibernate.envers.synchronization.work.AbstractAuditWorkUnit.perform(AbstractAuditWorkUnit.java:76)
	at org.hibernate.envers.synchronization.AuditProcess.executeInSession(AuditProcess.java:116)
	at org.hibernate.envers.synchronization.AuditProcess.doBeforeTransactionCompletion(AuditProcess.java:155)
	at org.hibernate.engine.spi.ActionQueue$BeforeTransactionCompletionProcessQueue.beforeTransactionCompletion(ActionQueue.java:662)
	at org.hibernate.engine.spi.ActionQueue.beforeTransactionCompletion(ActionQueue.java:307)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:611)
	at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.beforeTransactionCommit(JdbcTransaction.java:105)
	at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:175)
	at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:75)
	... 63 more
Caused by: java.sql.SQLException: A SELECT FOR UPDATE query cannot be used with DISTINCT, GROUP BY, HAVING, COMPUTE, UNION, aggregates, computed columns, subqueries or SELECT INTO.

	at com.sybase.jdbc4.jdbc.SybConnection.getAllExceptions(Unknown Source)
	at com.sybase.jdbc4.jdbc.SybStatement.handleSQLE(Unknown Source)
	at com.sybase.jdbc4.jdbc.SybStatement.nextResult(Unknown Source)
	at com.sybase.jdbc4.jdbc.SybStatement.nextResult(Unknown Source)
	at com.sybase.jdbc4.jdbc.SybStatement.queryLoop(Unknown Source)
	at com.sybase.jdbc4.jdbc.SybStatement.executeQuery(Unknown Source)
	at com.sybase.jdbc4.jdbc.SybPreparedStatement.executeQuery(Unknown Source)
	at sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:122)
	... 87 more

Standard Output

05:25:34,309  INFO DriverManagerConnectionProviderImpl:96 - HHH000402: Using Hibernate built-in connection pool (not for production use!)
05:25:34,309  INFO DriverManagerConnectionProviderImpl:130 - HHH000115: Hibernate connection pool size: 5
05:25:34,310  INFO DriverManagerConnectionProviderImpl:133 - HHH000006: Autocommit mode: true
05:25:34,310  INFO DriverManagerConnectionProviderImpl:147 - HHH000401: using driver [com.sybase.jdbc4.jdbc.SybDriver] at URL [jdbc:sybase:Tds:db05.mw.lab.eng.bos.redhat.com:5000/dballo01]
05:25:34,311  INFO DriverManagerConnectionProviderImpl:152 - HHH000046: Connection properties: {user=dballo01, password=****, autocommit=true, release_mode=auto}
05:25:34,336  INFO Dialect:122 - HHH000400: Using dialect: org.hibernate.dialect.SybaseASE157Dialect
05:25:34,339  INFO TransactionFactoryInitiator:73 - HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jdbc.JdbcTransactionFactory
05:25:34,339  INFO ASTQueryTranslatorFactory:48 - HHH000397: Using ASTQueryTranslatorFactory
05:25:34,340  WARN CachingRegionFactory:56 - CachingRegionFactory should be only used for testing.
05:25:34,375  INFO SchemaExport:343 - HHH000227: Running hbm2ddl schema export
05:25:34,377 DEBUG SchemaExport:353 - Import file not found: /import.sql
05:25:34,378 DEBUG SQL:104 - alter table ParentEntity_AUD drop constraint FK1C95449E67C021C6
05:25:34,379 ERROR SchemaExport:425 - HHH000389: Unsuccessful: alter table ParentEntity_AUD drop constraint FK1C95449E67C021C6
05:25:34,380 ERROR SchemaExport:426 - Cannot alter table 'ParentEntity_AUD', because this table does not exist in database 'dballo01'.

05:25:34,382 DEBUG SQL:104 - drop table ClassTypeEntity
05:25:34,384 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table ClassTypeEntity
05:25:34,385 ERROR SchemaExport:426 - Cannot drop the table 'ClassTypeEntity', because it doesn't exist in the system catalogs.

05:25:34,387 DEBUG SQL:104 - drop table ParentEntity
05:25:34,389 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table ParentEntity
05:25:34,390 ERROR SchemaExport:426 - Cannot drop the table 'ParentEntity', because it doesn't exist in the system catalogs.

05:25:34,391 DEBUG SQL:104 - drop table ParentEntity_AUD
05:25:34,393 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table ParentEntity_AUD
05:25:34,394 ERROR SchemaExport:426 - Cannot drop the table 'ParentEntity_AUD', because it doesn't exist in the system catalogs.

05:25:34,395 DEBUG SQL:104 - drop table REVINFO
05:25:34,397 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table REVINFO
05:25:34,398 ERROR SchemaExport:426 - Cannot drop the table 'REVINFO', because it doesn't exist in the system catalogs.

05:25:34,399 DEBUG SQL:104 - drop table REVISION_GENERATOR
05:25:34,401 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table REVISION_GENERATOR
05:25:34,402 ERROR SchemaExport:426 - Cannot drop the table 'REVISION_GENERATOR', because it doesn't exist in the system catalogs.

05:25:34,403 DEBUG SQL:104 - drop table hibernate_sequence
05:25:34,405 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table hibernate_sequence
05:25:34,406 ERROR SchemaExport:426 - Cannot drop the table 'hibernate_sequence', because it doesn't exist in the system catalogs.

05:25:34,407 DEBUG SQL:104 - create table ClassTypeEntity (id bigint not null, type varchar(255), primary key (id))
05:25:34,434 DEBUG SQL:104 - create table ParentEntity (id bigint not null, data varchar(255), typeId bigint, specificData varchar(255), primary key (id))
05:25:34,464 DEBUG SQL:104 - create table ParentEntity_AUD (id bigint not null, REV int not null, REVTYPE smallint, data varchar(255), typeId bigint, specificData varchar(255), primary key (id, REV))
05:25:34,488 DEBUG SQL:104 - create table REVINFO (REV int not null, REVTSTMP bigint, primary key (REV))
05:25:34,519 DEBUG SQL:104 - alter table ParentEntity_AUD add constraint FK1C95449E67C021C6 foreign key (REV) references REVINFO
05:25:34,525 DEBUG SQL:104 - create table REVISION_GENERATOR ( next_val bigint )
05:25:34,549 DEBUG SQL:104 - insert into REVISION_GENERATOR values ( 1 )
05:25:34,555 DEBUG SQL:104 - create table hibernate_sequence ( next_val bigint )
05:25:34,573 DEBUG SQL:104 - insert into hibernate_sequence values ( 1 )
05:25:34,579  INFO SchemaExport:405 - HHH000230: Schema export complete
05:25:34,601 DEBUG SQL:104 - select next_val as id_val from hibernate_sequence for update
05:25:34,605 DEBUG SQL:104 - update hibernate_sequence set next_val= ? where next_val=?
05:25:34,618 DEBUG SQL:104 - insert into ClassTypeEntity (type, id) values (?, ?)
05:25:34,634 DEBUG SQL:104 - select next_val as id_val from hibernate_sequence for update
05:25:34,638 DEBUG SQL:104 - update hibernate_sequence set next_val= ? where next_val=?
05:25:34,646 DEBUG SQL:104 - insert into ClassTypeEntity (type, id) values (?, ?)
05:25:34,652 DEBUG SQL:104 - select next_val as id_val from hibernate_sequence for update
05:25:34,661 DEBUG SQL:104 - update hibernate_sequence set next_val= ? where next_val=?
05:25:34,671 DEBUG SQL:104 - insert into ParentEntity (data, typeId, specificData, id) values (?, ?, ?, ?)
05:25:34,674 DEBUG SQL:104 - select next_val as id_val from REVISION_GENERATOR for update
05:25:34,678 DEBUG SQL:104 - update REVISION_GENERATOR set next_val= ? where next_val=?
05:25:34,689 DEBUG SQL:104 - insert into REVINFO (REVTSTMP, REV) values (?, ?)
05:25:34,694 DEBUG SQL:104 - insert into ParentEntity_AUD (REVTYPE, data, typeId, specificData, id, REV) values (?, ?, ?, ?, ?, ?)
05:25:34,706 DEBUG SQL:104 - select next_val as id_val from hibernate_sequence for update
05:25:34,710 DEBUG SQL:104 - update hibernate_sequence set next_val= ? where next_val=?
05:25:34,718 DEBUG SQL:104 - insert into ParentEntity (data, typeId, id) values (?, ?, ?)
05:25:34,722 DEBUG SQL:104 - select next_val as id_val from REVISION_GENERATOR for update
05:25:34,726 DEBUG SQL:104 - update REVISION_GENERATOR set next_val= ? where next_val=?
05:25:34,742 DEBUG SQL:104 - insert into REVINFO (REVTSTMP, REV) values (?, ?)
05:25:34,745 DEBUG SQL:104 - insert into ParentEntity_AUD (REVTYPE, data, typeId, id, REV) values (?, ?, ?, ?, ?)
05:25:34,755 DEBUG SQL:104 - update ParentEntity set data=?, typeId=?, specificData=? where id=?
05:25:34,759 DEBUG SQL:104 - select next_val as id_val from REVISION_GENERATOR for update
05:25:34,763 DEBUG SQL:104 - update REVISION_GENERATOR set next_val= ? where next_val=?
05:25:34,778 DEBUG SQL:104 - insert into REVINFO (REVTSTMP, REV) values (?, ?)
05:25:34,782 DEBUG SQL:104 - insert into ParentEntity_AUD (REVTYPE, data, typeId, specificData, id, REV) values (?, ?, ?, ?, ?, ?)
05:25:34,791 DEBUG SQL:104 - update ParentEntity set data=?, typeId=? where id=?
05:25:34,795 DEBUG SQL:104 - select next_val as id_val from REVISION_GENERATOR for update
05:25:34,798 DEBUG SQL:104 - update REVISION_GENERATOR set next_val= ? where next_val=?
05:25:34,809 DEBUG SQL:104 - insert into REVINFO (REVTSTMP, REV) values (?, ?)
05:25:34,812 DEBUG SQL:104 - insert into ParentEntity_AUD (REVTYPE, data, typeId, id, REV) values (?, ?, ?, ?, ?)
05:25:34,820  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:34,836 DEBUG SQL:104 - select childentit0_.id as id1280_, childentit0_.REV as REV1280_, childentit0_.REVTYPE as REVTYPE1280_, childentit0_.data as data1280_, childentit0_.typeId as typeId1280_, childentit0_.specificData as specificData1280_ from ParentEntity_AUD childentit0_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit0_.typeId)='Child' and childentit0_.REV=(select max(childentit1_.REV) from ParentEntity_AUD childentit1_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit1_.typeId)='Child' and childentit1_.REV<=? and childentit0_.id=childentit1_.id) and childentit0_.REVTYPE<>? and childentit0_.id=?
05:25:34,849 DEBUG SQL:104 - select childentit0_.id as id1280_, childentit0_.REV as REV1280_, childentit0_.REVTYPE as REVTYPE1280_, childentit0_.data as data1280_, childentit0_.typeId as typeId1280_, childentit0_.specificData as specificData1280_ from ParentEntity_AUD childentit0_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit0_.typeId)='Child' and childentit0_.REV=(select max(childentit1_.REV) from ParentEntity_AUD childentit1_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit1_.typeId)='Child' and childentit1_.REV<=? and childentit0_.id=childentit1_.id) and childentit0_.REVTYPE<>? and childentit0_.id=?
05:25:34,859  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:34,873 DEBUG SQL:104 - select parententi0_.id as id1280_, parententi0_.REV as REV1280_, parententi0_.REVTYPE as REVTYPE1280_, parententi0_.data as data1280_, parententi0_.typeId as typeId1280_, parententi0_.specificData as specificData1280_, (SELECT c.type FROM ClassTypeEntity c WHERE c.id = parententi0_.typeId) as clazz_ from ParentEntity_AUD parententi0_ where parententi0_.REV=(select max(parententi1_.REV) from ParentEntity_AUD parententi1_ where parententi1_.REV<=? and parententi0_.id=parententi1_.id) and parententi0_.REVTYPE<>? and parententi0_.id=?
05:25:34,882 DEBUG SQL:104 - select parententi0_.id as id1280_, parententi0_.REV as REV1280_, parententi0_.REVTYPE as REVTYPE1280_, parententi0_.data as data1280_, parententi0_.typeId as typeId1280_, parententi0_.specificData as specificData1280_, (SELECT c.type FROM ClassTypeEntity c WHERE c.id = parententi0_.typeId) as clazz_ from ParentEntity_AUD parententi0_ where parententi0_.REV=(select max(parententi1_.REV) from ParentEntity_AUD parententi1_ where parententi1_.REV<=? and parententi0_.id=parententi1_.id) and parententi0_.REVTYPE<>? and parententi0_.id=?
05:25:34,890  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:34,907 DEBUG SQL:104 - select childentit0_.id as id1280_, childentit0_.REV as REV1280_, childentit0_.REVTYPE as REVTYPE1280_, childentit0_.data as data1280_, childentit0_.typeId as typeId1280_, childentit0_.specificData as specificData1280_ from ParentEntity_AUD childentit0_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit0_.typeId)='Child' and childentit0_.REV=(select max(childentit1_.REV) from ParentEntity_AUD childentit1_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit1_.typeId)='Child' and childentit1_.REV<=? and childentit0_.id=childentit1_.id) and childentit0_.REVTYPE<>?
05:25:34,927 DEBUG SQL:104 - select parententi0_.id as id1280_, parententi0_.REV as REV1280_, parententi0_.REVTYPE as REVTYPE1280_, parententi0_.data as data1280_, parententi0_.typeId as typeId1280_, parententi0_.specificData as specificData1280_, (SELECT c.type FROM ClassTypeEntity c WHERE c.id = parententi0_.typeId) as clazz_ from ParentEntity_AUD parententi0_ where parententi0_.REV=(select max(parententi1_.REV) from ParentEntity_AUD parententi1_ where parententi1_.REV<=? and parententi0_.id=parententi1_.id) and parententi0_.REVTYPE<>?
05:25:34,940 DEBUG SQL:104 - select childentit0_.id as id1280_, childentit0_.REV as REV1280_, childentit0_.REVTYPE as REVTYPE1280_, childentit0_.data as data1280_, childentit0_.typeId as typeId1280_, childentit0_.specificData as specificData1280_ from ParentEntity_AUD childentit0_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit0_.typeId)='Child' and childentit0_.REVTYPE<>? order by childentit0_.REV asc
05:25:34,952 DEBUG SQL:104 - select parententi0_.id as id1280_, parententi0_.REV as REV1280_, parententi0_.REVTYPE as REVTYPE1280_, parententi0_.data as data1280_, parententi0_.typeId as typeId1280_, parententi0_.specificData as specificData1280_, (SELECT c.type FROM ClassTypeEntity c WHERE c.id = parententi0_.typeId) as clazz_ from ParentEntity_AUD parententi0_ where parententi0_.REVTYPE<>? order by parententi0_.REV asc
05:25:34,959  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:34,973 DEBUG SQL:104 - select childentit0_.REV as col_0_0_ from ParentEntity_AUD childentit0_, REVINFO sequenceid1_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit0_.typeId)='Child' and childentit0_.id=? and childentit0_.REV=sequenceid1_.REV order by childentit0_.REV asc
05:25:34,988 DEBUG SQL:104 - select parententi0_.REV as col_0_0_ from ParentEntity_AUD parententi0_, REVINFO sequenceid1_ where parententi0_.id=? and parententi0_.REV=sequenceid1_.REV order by parententi0_.REV asc
05:25:34,994  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:34,995  INFO SchemaExport:343 - HHH000227: Running hbm2ddl schema export
05:25:34,997 DEBUG SchemaExport:353 - Import file not found: /import.sql
05:25:34,998 DEBUG SQL:104 - alter table ParentEntity_AUD drop constraint FK1C95449E67C021C6
05:25:35,004 DEBUG SQL:104 - drop table ClassTypeEntity
05:25:35,016 DEBUG SQL:104 - drop table ParentEntity
05:25:35,022 DEBUG SQL:104 - drop table ParentEntity_AUD
05:25:35,028 DEBUG SQL:104 - drop table REVINFO
05:25:35,040 DEBUG SQL:104 - drop table REVISION_GENERATOR
05:25:35,046 DEBUG SQL:104 - drop table hibernate_sequence
05:25:35,052  INFO SchemaExport:405 - HHH000230: Schema export complete
05:25:35,053  INFO DriverManagerConnectionProviderImpl:156 - HHH000030: Cleaning up connection pool [jdbc:sybase:Tds:db05.mw.lab.eng.bos.redhat.com:5000/dballo01]
05:25:35,060  INFO DriverManagerConnectionProviderImpl:96 - HHH000402: Using Hibernate built-in connection pool (not for production use!)
05:25:35,061  INFO DriverManagerConnectionProviderImpl:130 - HHH000115: Hibernate connection pool size: 5
05:25:35,062  INFO DriverManagerConnectionProviderImpl:133 - HHH000006: Autocommit mode: true
05:25:35,062  INFO DriverManagerConnectionProviderImpl:147 - HHH000401: using driver [com.sybase.jdbc4.jdbc.SybDriver] at URL [jdbc:sybase:Tds:db05.mw.lab.eng.bos.redhat.com:5000/dballo01]
05:25:35,063  INFO DriverManagerConnectionProviderImpl:152 - HHH000046: Connection properties: {user=dballo01, password=****, autocommit=true, release_mode=auto}
05:25:35,079  INFO Dialect:122 - HHH000400: Using dialect: org.hibernate.dialect.SybaseASE157Dialect
05:25:35,081  INFO TransactionFactoryInitiator:73 - HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jdbc.JdbcTransactionFactory
05:25:35,082  INFO ASTQueryTranslatorFactory:48 - HHH000397: Using ASTQueryTranslatorFactory
05:25:35,082  WARN CachingRegionFactory:56 - CachingRegionFactory should be only used for testing.
05:25:35,118  INFO SchemaExport:343 - HHH000227: Running hbm2ddl schema export
05:25:35,119 DEBUG SchemaExport:353 - Import file not found: /import.sql
05:25:35,120 DEBUG SQL:104 - alter table ParentEntity_AUD drop constraint FK1C95449E300D527B
05:25:35,121 ERROR SchemaExport:425 - HHH000389: Unsuccessful: alter table ParentEntity_AUD drop constraint FK1C95449E300D527B
05:25:35,121 ERROR SchemaExport:426 - Cannot alter table 'ParentEntity_AUD', because this table does not exist in database 'dballo01'.

05:25:35,122 DEBUG SQL:104 - alter table ParentEntity_AUD drop constraint FK1C95449E67C021C6
05:25:35,123 ERROR SchemaExport:425 - HHH000389: Unsuccessful: alter table ParentEntity_AUD drop constraint FK1C95449E67C021C6
05:25:35,123 ERROR SchemaExport:426 - Cannot alter table 'ParentEntity_AUD', because this table does not exist in database 'dballo01'.

05:25:35,123 DEBUG SQL:104 - drop table ClassTypeEntity
05:25:35,124 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table ClassTypeEntity
05:25:35,125 ERROR SchemaExport:426 - Cannot drop the table 'ClassTypeEntity', because it doesn't exist in the system catalogs.

05:25:35,125 DEBUG SQL:104 - drop table ParentEntity
05:25:35,126 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table ParentEntity
05:25:35,127 ERROR SchemaExport:426 - Cannot drop the table 'ParentEntity', because it doesn't exist in the system catalogs.

05:25:35,128 DEBUG SQL:104 - drop table ParentEntity_AUD
05:25:35,130 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table ParentEntity_AUD
05:25:35,130 ERROR SchemaExport:426 - Cannot drop the table 'ParentEntity_AUD', because it doesn't exist in the system catalogs.

05:25:35,131 DEBUG SQL:104 - drop table REVINFO
05:25:35,133 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table REVINFO
05:25:35,134 ERROR SchemaExport:426 - Cannot drop the table 'REVINFO', because it doesn't exist in the system catalogs.

05:25:35,134 DEBUG SQL:104 - drop table REVISION_GENERATOR
05:25:35,136 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table REVISION_GENERATOR
05:25:35,137 ERROR SchemaExport:426 - Cannot drop the table 'REVISION_GENERATOR', because it doesn't exist in the system catalogs.

05:25:35,138 DEBUG SQL:104 - drop table hibernate_sequence
05:25:35,139 ERROR SchemaExport:425 - HHH000389: Unsuccessful: drop table hibernate_sequence
05:25:35,140 ERROR SchemaExport:426 - Cannot drop the table 'hibernate_sequence', because it doesn't exist in the system catalogs.

05:25:35,141 DEBUG SQL:104 - create table ClassTypeEntity (id bigint not null, type varchar(255), primary key (id))
05:25:35,285 DEBUG SQL:104 - create table ParentEntity (id bigint not null, data varchar(255), typeId bigint, specificData varchar(255), primary key (id))
05:25:35,309 DEBUG SQL:104 - create table ParentEntity_AUD (id bigint not null, REV int not null, REVTYPE smallint, REVEND int, data varchar(255), typeId bigint, specificData varchar(255), primary key (id, REV))
05:25:35,339 DEBUG SQL:104 - create table REVINFO (REV int not null, REVTSTMP bigint, primary key (REV))
05:25:35,369 DEBUG SQL:104 - alter table ParentEntity_AUD add constraint FK1C95449E300D527B foreign key (REVEND) references REVINFO
05:25:35,375 DEBUG SQL:104 - alter table ParentEntity_AUD add constraint FK1C95449E67C021C6 foreign key (REV) references REVINFO
05:25:35,381 DEBUG SQL:104 - create table REVISION_GENERATOR ( next_val bigint )
05:25:35,405 DEBUG SQL:104 - insert into REVISION_GENERATOR values ( 1 )
05:25:35,411 DEBUG SQL:104 - create table hibernate_sequence ( next_val bigint )
05:25:35,435 DEBUG SQL:104 - insert into hibernate_sequence values ( 1 )
05:25:35,441  INFO SchemaExport:405 - HHH000230: Schema export complete
05:25:35,461 DEBUG SQL:104 - select next_val as id_val from hibernate_sequence for update
05:25:35,463 DEBUG SQL:104 - update hibernate_sequence set next_val= ? where next_val=?
05:25:35,474 DEBUG SQL:104 - insert into ClassTypeEntity (type, id) values (?, ?)
05:25:35,485 DEBUG SQL:104 - select next_val as id_val from hibernate_sequence for update
05:25:35,487 DEBUG SQL:104 - update hibernate_sequence set next_val= ? where next_val=?
05:25:35,497 DEBUG SQL:104 - insert into ClassTypeEntity (type, id) values (?, ?)
05:25:35,503 DEBUG SQL:104 - select next_val as id_val from hibernate_sequence for update
05:25:35,505 DEBUG SQL:104 - update hibernate_sequence set next_val= ? where next_val=?
05:25:35,515 DEBUG SQL:104 - insert into ParentEntity (data, typeId, specificData, id) values (?, ?, ?, ?)
05:25:35,518 DEBUG SQL:104 - select next_val as id_val from REVISION_GENERATOR for update
05:25:35,520 DEBUG SQL:104 - update REVISION_GENERATOR set next_val= ? where next_val=?
05:25:35,527 DEBUG SQL:104 - insert into REVINFO (REVTSTMP, REV) values (?, ?)
05:25:35,531 DEBUG SQL:104 - insert into ParentEntity_AUD (REVTYPE, REVEND, data, typeId, specificData, id, REV) values (?, ?, ?, ?, ?, ?, ?)
05:25:35,545 DEBUG SQL:104 - select next_val as id_val from hibernate_sequence for update
05:25:35,547 DEBUG SQL:104 - update hibernate_sequence set next_val= ? where next_val=?
05:25:35,557 DEBUG SQL:104 - insert into ParentEntity (data, typeId, id) values (?, ?, ?)
05:25:35,560 DEBUG SQL:104 - select next_val as id_val from REVISION_GENERATOR for update
05:25:35,562 DEBUG SQL:104 - update REVISION_GENERATOR set next_val= ? where next_val=?
05:25:35,569 DEBUG SQL:104 - insert into REVINFO (REVTSTMP, REV) values (?, ?)
05:25:35,571 DEBUG SQL:104 - insert into ParentEntity_AUD (REVTYPE, REVEND, data, typeId, id, REV) values (?, ?, ?, ?, ?, ?)
05:25:35,581 DEBUG SQL:104 - update ParentEntity set data=?, typeId=?, specificData=? where id=?
05:25:35,584 DEBUG SQL:104 - select next_val as id_val from REVISION_GENERATOR for update
05:25:35,586 DEBUG SQL:104 - update REVISION_GENERATOR set next_val= ? where next_val=?
05:25:35,602 DEBUG SQL:104 - select childentit0_.id as id1290_, childentit0_.REV as REV1290_, childentit0_.REVTYPE as REVTYPE1290_, childentit0_.REVEND as REVEND1290_, childentit0_.data as data1290_, childentit0_.typeId as typeId1290_, childentit0_.specificData as specificData1290_ from ParentEntity_AUD childentit0_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit0_.typeId)='Child' and childentit0_.id=? and (childentit0_.REVEND is null) for update
05:25:35,604  WARN SqlExceptionHelper:143 - SQL Error: 16336, SQLState: ZZZZZ
05:25:35,604 ERROR SqlExceptionHelper:144 - A SELECT FOR UPDATE query cannot be used with DISTINCT, GROUP BY, HAVING, COMPUTE, UNION, aggregates, computed columns, subqueries or SELECT INTO.

05:25:35,617  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:35,624  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:35,626  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:35,638 DEBUG SQL:104 - select childentit0_.id as id1290_, childentit0_.REV as REV1290_, childentit0_.REVTYPE as REVTYPE1290_, childentit0_.REVEND as REVEND1290_, childentit0_.data as data1290_, childentit0_.typeId as typeId1290_, childentit0_.specificData as specificData1290_ from ParentEntity_AUD childentit0_ where (SELECT c.type FROM ClassTypeEntity c WHERE c.id = childentit0_.typeId)='Child' and childentit0_.REV<=? and childentit0_.REVTYPE<>? and (childentit0_.REVEND>? or childentit0_.REVEND is null)
05:25:35,643  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:35,646  WARN BaseEnversJPAFunctionalTestCase:270 - The EntityManager is not closed. Closing it.
05:25:35,648  INFO SchemaExport:343 - HHH000227: Running hbm2ddl schema export
05:25:35,650 DEBUG SchemaExport:353 - Import file not found: /import.sql
05:25:35,650 DEBUG SQL:104 - alter table ParentEntity_AUD drop constraint FK1C95449E300D527B
05:25:35,657 DEBUG SQL:104 - alter table ParentEntity_AUD drop constraint FK1C95449E67C021C6
05:25:35,663 DEBUG SQL:104 - drop table ClassTypeEntity
05:25:35,675 DEBUG SQL:104 - drop table ParentEntity
05:25:35,681 DEBUG SQL:104 - drop table ParentEntity_AUD
05:25:35,693 DEBUG SQL:104 - drop table REVINFO
05:25:35,699 DEBUG SQL:104 - drop table REVISION_GENERATOR
05:25:35,705 DEBUG SQL:104 - drop table hibernate_sequence
05:25:35,717  INFO SchemaExport:405 - HHH000230: Schema export complete
05:25:35,717  INFO DriverManagerConnectionProviderImpl:156 - HHH000030: Cleaning up connection pool [jdbc:sybase:Tds:db05.mw.lab.eng.bos.redhat.com:5000/dballo01]

