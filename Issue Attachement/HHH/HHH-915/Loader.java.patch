47d46
< import org.hibernate.loader.custom.CustomLoader;
408,409c407,410
< 			int count = 0;
< 			boolean hasNoResult = false;
---
> 			int count;
> 			for ( count = 0; count < maxRows && rs.next(); count++ ) {
> 				
> 				if ( log.isTraceEnabled() ) log.debug("result set row: " + count);
411,440c412,424
< 			// hc: see if the query actually returns no meaningful result.
< 			if (this instanceof CustomLoader) {
< 				CustomLoader cl = (CustomLoader)this;
< 				hasNoResult = cl.hasNoResult();
< 			}
< 			
< 			if (hasNoResult) {
< 				// hc: query has no meaningful result, and is executed only for it's side effect (eg bulk insertion) 
< 				getRowFromResultSet(rs, session, queryParameters, lockModeArray, optionalObjectKey, hydratedObjects, keys, returnProxies);
< 			}
< 			else {
< 				for (; count < maxRows && rs.next(); count++ ) {
< 					
< 					if ( log.isTraceEnabled() ) log.debug("result set row: " + count);
< 	
< 					Object result = getRowFromResultSet( rs,
< 							session,
< 							queryParameters,
< 							lockModeArray,
< 							optionalObjectKey,
< 							hydratedObjects,
< 							keys,
< 							returnProxies );
< 					results.add( result );
< 	
< 					if ( createSubselects ) {
< 						subselectResultKeys.add(keys);
< 						keys = new EntityKey[entitySpan]; //can't reuse in this case
< 					}
< 					
---
> 				Object result = getRowFromResultSet( rs,
> 						session,
> 						queryParameters,
> 						lockModeArray,
> 						optionalObjectKey,
> 						hydratedObjects,
> 						keys,
> 						returnProxies );
> 				results.add( result );
> 
> 				if ( createSubselects ) {
> 					subselectResultKeys.add(keys);
> 					keys = new EntityKey[entitySpan]; //can't reuse in this case
441a426
> 				
