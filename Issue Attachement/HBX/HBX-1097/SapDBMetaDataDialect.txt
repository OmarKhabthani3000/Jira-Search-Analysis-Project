package org.hibernate.cfg.reveng.dialect;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Map;


/**
 * SapDB-specific MetaDataDialect
 * @author Laurence Sargent
 * @email laurence_sargent@yahoo.com
 */

public class SapDBMetaDataDialect extends JDBCMetaDataDialect {

	
	//Forcing null ensures that foreign keys are read correctly

	protected void putExportedKeysPart(Map element, ResultSet rs) throws SQLException {
		
		element.put( "PKTABLE_NAME", rs.getString("PKTABLE_NAME"));
		element.put( "PKTABLE_SCHEM", rs.getString("PKTABLE_SCHEM"));
		
		String pkTableCat = null;
		if (rs.getString("PKTABLE_CAT")!=null && rs.getString("PKTABLE_CAT").length()>0)
			pkTableCat = rs.getString("PKTABLE_CAT");
		
		element.put( "PKTABLE_CAT", pkTableCat);
		
		String fkTableCat = null;
		if (rs.getString("FKTABLE_CAT")!=null && rs.getString("FKTABLE_CAT").length()>0)
			fkTableCat = rs.getString("FKTABLE_CAT");
		
		element.put( "FKTABLE_CAT", fkTableCat);				
		element.put( "FKTABLE_SCHEM",rs.getString("FKTABLE_SCHEM"));
		element.put( "FKTABLE_NAME", rs.getString("FKTABLE_NAME"));
		element.put( "FKCOLUMN_NAME", rs.getString("FKCOLUMN_NAME"));
		element.put( "PKCOLUMN_NAME", rs.getString("PKCOLUMN_NAME"));
		element.put( "FK_NAME", rs.getString("FK_NAME"));
		element.put( "KEY_SEQ", new Short(rs.getShort("KEY_SEQ")));
		
	}
	
}
