? HibernateExt/org.hibernate.eclipse/.settings
? HibernateExt/org.hibernate.eclipse.console/.settings
? HibernateExt/org.hibernate.eclipse.help/.settings
? HibernateExt/org.hibernate.eclipse.mapper/.settings
? HibernateExt/tools/src/java/org/hibernate/tool/hbm2x/DAOExporter.java.original
Index: HibernateExt/build.bat
===================================================================
RCS file: /cvsroot/hibernate/HibernateExt/build.bat,v
retrieving revision 1.3
diff -n -r1.3 build.bat
d1 1
a1 1
set HIBERNATECORE=%~dp0..\hibernate-3.1
Index: HibernateExt/build.xml
===================================================================
RCS file: /cvsroot/hibernate/HibernateExt/build.xml,v
retrieving revision 1.9
diff -n -r1.9 build.xml
d20 1
a20 1
  <property name="version" value="3.1"/>
a28 6
  
  <target name="tools" depends="" description="Build just tools">
	<subant inheritall="false">
      <fileset dir="." includes="tools/build.xml"/>
	</subant>
  </target>  
Index: HibernateExt/org.hibernate.eclipse/.classpath
===================================================================
RCS file: /cvsroot/hibernate/HibernateExt/org.hibernate.eclipse/.classpath,v
retrieving revision 1.9
diff -n -r1.9 .classpath
d3 1
a3 1
	<classpathentry kind="src" path="src"/>
d8 1
d17 1
a17 1
	<classpathentry exported="true" sourcepath="C:/work/hibernate-3/HibernateExt/tools/src/java" kind="lib" path="lib/hibernate-tools.jar"/>
a35 1
	<classpathentry kind="lib" path="lib/cglib-2.1.1.jar"/>
Index: HibernateExt/org.hibernate.eclipse.console/src/org/hibernate/eclipse/console/wizards/ArtifactGeneratorWizard.java
===================================================================
RCS file: /cvsroot/hibernate/HibernateExt/org.hibernate.eclipse.console/src/org/hibernate/eclipse/console/wizards/ArtifactGeneratorWizard.java,v
retrieving revision 1.19
diff -n -r1.19 ArtifactGeneratorWizard.java
a31 1
import org.hibernate.tool.hbm2x.DAOExporter;
a87 1
        final boolean gendao = page.isGenerateDao();
d98 1
a98 1
					doFinish(configurationName, output, outputPackage, revengsettings, reveng, genjava, gendao, genhbm, gencfg, monitor, preferRaw, templatedir, ejb3, gendoc);
d134 1
a134 1
		String outputPackage, IPath revengsettings, boolean reveng, final boolean genjava, final boolean gendao, final boolean genhbm, final boolean gencfg, final IProgressMonitor monitor, boolean preferRawCompositeids, IPath templateDir, final boolean ejb3, final boolean gendoc)
a182 2
                // Add support for DAO generation
                final DAOExporter daoExporter = new DAOExporter(cfg,outputdir);
a195 6
                
                if(gendao) {
                    monitor.subTask("DAO code");
                    daoExporter.start();
                    monitor.worked(7);
                }
d200 1
a200 1
					monitor.worked(8);
d206 1
a206 1
					monitor.worked(9);
Index: HibernateExt/org.hibernate.eclipse.console/src/org/hibernate/eclipse/console/wizards/BasicGeneratorSettingsPage.java
===================================================================
RCS file: /cvsroot/hibernate/HibernateExt/org.hibernate.eclipse.console/src/org/hibernate/eclipse/console/wizards/BasicGeneratorSettingsPage.java,v
retrieving revision 1.8
diff -n -r1.8 BasicGeneratorSettingsPage.java
a53 2
    private SelectionButtonDialogField generatedao;
    
d93 1
a93 1
		layout.verticalSpacing = 10;
a162 3
        generatedao = new SelectionButtonDialogField(SWT.CHECK);
        generatedao.setLabelText("Generate DAO code (.java)");
        
a193 1
        generatedao.doFillIntoGrid(container, 3);
a345 7
    
    /**
     * @return
     */
    public boolean isGenerateDao() {
        return generatedao.isSelected();
    }   
Index: HibernateExt/tools/src/java/org/hibernate/tool/hbm2x/DAOExporter.java
===================================================================
RCS file: /cvsroot/hibernate/HibernateExt/tools/src/java/org/hibernate/tool/hbm2x/DAOExporter.java,v
retrieving revision 1.2
diff -n -r1.2 DAOExporter.java
a8 3
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

d11 12
a22 41
    private static final String DAO_DAOHOME_VM = "dao/daohome.vm";

    private static final Log log = LogFactory.getLog(DAOExporter.class);

    String templateName = DAO_DAOHOME_VM;

    public DAOExporter(Configuration cfg, File outputdir) {
        super(cfg, outputdir);
        log.info("Starting ...");
    }

    public boolean startComponent(Component component) throws ExporterException {
        // we ignore
        return false;
    }

    protected String getNameForClass(PersistentClass clazz) {
        String className = super.getNameForClass(clazz) + "DAO";
        log.info("DAO class: " + className);
        return className;
    }

    public void exportPersistentClass(PersistentClass clazz) {
        runVelocity(clazz, getNameForClass(clazz), templateName);
    }

    public void start() {
        // TODO Auto-generated method stub
        super.start();
    }

    public void exportComponent(Component component) throws ExporterException {
        return;
    }

    protected void runVelocity(Object clazz, String qualifiedDeclarationName,
            String templateName) {
        log.info("Generating " + qualifiedDeclarationName + " with "
                + templateName);
        super.runVelocity(clazz, qualifiedDeclarationName, templateName);
    }
Index: HibernateExt/tools/src/velocity/dao/daohome.vm
===================================================================
RCS file: /cvsroot/hibernate/HibernateExt/tools/src/velocity/dao/daohome.vm,v
retrieving revision 1.2
diff -n -r1.2 daohome.vm
d3 4
a6 1

d8 1
a8 1
import org.hibernate.criterion.Example;
a10 1
import javax.naming.InitialContext;
d12 7
a18 1
#set($cls = ".class")
d20 1
a20 3
public class $c2j.getDeclarationName($clazz)DAO {

    private static final Log log = LogFactory.getLog($c2j.getDeclarationName($clazz)DAO\$cls);
d22 53
d79 1
a79 2
        	InitialContext ctx = new InitialContext();
            return (SessionFactory) ctx.lookup("SessionFactory");
d149 1
a149 1
    public $c2j.getDeclarationName($clazz) findById($c2j.stripPackage( $c2j.getJavaTypeName($clazz.identifierProperty), $clazz ) id) {
d152 1
a152 1
            $c2j.getDeclarationName($clazz) instance = ($c2j.getDeclarationName($clazz)) sessionFactory.getCurrentSession()
d169 1
a169 1
        log.debug("finding $c2j.getDeclarationName($clazz) instance by example");
d171 1
a171 1
            List results = sessionFactory.getCurrentSession()
d185 1
a185 1

