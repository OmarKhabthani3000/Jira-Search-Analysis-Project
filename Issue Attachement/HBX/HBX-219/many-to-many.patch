Index: Cfg2JavaTool.java
===================================================================
RCS file: /cvsroot/hibernate/HibernateExt/tools/src/java/org/hibernate/tool/hbm2x/Cfg2JavaTool.java,v
retrieving revision 1.23
diff -u -r1.23 Cfg2JavaTool.java
--- Cfg2JavaTool.java	18 May 2005 13:59:02 -0000	1.23
+++ Cfg2JavaTool.java	17 Jun 2005 21:15:13 -0000
@@ -22,6 +22,7 @@
 import org.hibernate.mapping.Array;
 import org.hibernate.mapping.Collection;
 import org.hibernate.mapping.Component;
+import org.hibernate.mapping.ManyToOne;
 import org.hibernate.mapping.MetaAttributable;
 import org.hibernate.mapping.MetaAttribute;
 import org.hibernate.mapping.OneToMany;
@@ -550,8 +551,12 @@
     			if (value instanceof Collection)
     			{
     				Collection collection = (Collection) value;
-    				OneToMany oneToMany = (OneToMany) collection.getElement();
-    				String entityType = oneToMany.getAssociatedClass().getClassName();
+    				Object element = collection.getElement();
+    				String entityType;
+    				if (element instanceof OneToMany)
+        				entityType = ((OneToMany) element).getReferencedEntityName();
+    				else
+    					entityType = ((ManyToOne) element).getReferencedEntityName();
     				
     				return toName(p.getType().getReturnedClass()) + "<" + entityType + ">";
     			}
