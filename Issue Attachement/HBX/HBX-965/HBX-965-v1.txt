Index: H2MetaDataDialect.java
===================================================================
--- H2MetaDataDialect.java	(revision 12767)
+++ H2MetaDataDialect.java	(working copy)
@@ -8,6 +8,7 @@
 import java.util.Map;
 
 import org.hibernate.util.StringHelper;
+import org.hibernate.util.ReflectHelper;
 
 
 /**
@@ -18,16 +19,35 @@
  */
 public class H2MetaDataDialect extends JDBCMetaDataDialect {
 
-	/*protected void putTablePart(Map element, ResultSet tableRs) throws SQLException {		
+	private static boolean understandsCatalogName = true;
+
+	public H2MetaDataDialect() {
+		super();
+		try {
+			Class constants = ReflectHelper.classForName( "org.h2.engine.Constants" );
+			Integer build = (Integer)constants.getDeclaredField( "BUILD_ID" ).get( null );
+			if ( build.intValue() < 55 ) {
+				understandsCatalogName = false;
+			}
+		}
+        catch( Throwable e ) {
+            // ignore (probably H2 not in the classpath)
+        }
+	}
+
+	protected void putTablePart(Map element, ResultSet tableRs) throws SQLException {		
 		super.putTablePart( element, tableRs );
-		element.put("TABLE_CAT", null);
+		if ( !understandsCatalogName ) {
+			element.put( "TABLE_CAT", null );
+		}
 	}
 	
 	protected void putExportedKeysPart(Map element, ResultSet rs) throws SQLException {		
 		super.putExportedKeysPart( element, rs );
-		element.put( "PKTABLE_CAT", null);
-		element.put( "FKTABLE_CAT", null);
-	}*/
+		if ( !understandsCatalogName ) {
+			element.put( "PKTABLE_CAT", null );
+		}
+	}
 	
 	public Iterator getSuggestedPrimaryKeyStrategyName(String catalog, String schema, String table) {
 			try {			
