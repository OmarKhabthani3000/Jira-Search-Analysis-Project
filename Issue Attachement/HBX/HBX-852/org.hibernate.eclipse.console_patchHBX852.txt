Index: D:/workspaces/hibernate/org.hibernate.eclipse.console/META-INF/MANIFEST.MF
===================================================================
--- D:/workspaces/hibernate/org.hibernate.eclipse.console/META-INF/MANIFEST.MF	(revision 6766)
+++ D:/workspaces/hibernate/org.hibernate.eclipse.console/META-INF/MANIFEST.MF	(working copy)
@@ -1,7 +1,7 @@
 Manifest-Version: 1.0
 Bundle-ManifestVersion: 2
 Bundle-Name: Hibernate Console
-Bundle-SymbolicName: org.hibernate.eclipse.console; singleton:=true
+Bundle-SymbolicName: org.hibernate.eclipse.console;singleton:=true
 Bundle-Version: 3.2.0.beta9
 Bundle-ClassPath: org.hibernate.eclipse.console.jar
 Bundle-Activator: org.hibernate.eclipse.console.HibernateConsolePlugin
Index: D:/workspaces/hibernate/org.hibernate.eclipse.console/src/org/hibernate/eclipse/console/actions/OpenQueryEditorActionDelegate.java
===================================================================
--- D:/workspaces/hibernate/org.hibernate.eclipse.console/src/org/hibernate/eclipse/console/actions/OpenQueryEditorActionDelegate.java	(revision 0)
+++ D:/workspaces/hibernate/org.hibernate.eclipse.console/src/org/hibernate/eclipse/console/actions/OpenQueryEditorActionDelegate.java	(revision 0)
@@ -0,0 +1,79 @@
+/*******************************************************************************
+  * Copyright (c) 2007-2008 Red Hat, Inc.
+  * Distributed under license by Red Hat, Inc. All rights reserved.
+  * This program is made available under the terms of the
+  * Eclipse Public License v1.0 which accompanies this distribution,
+  * and is available at http://www.eclipse.org/legal/epl-v10.html
+  *
+  * Contributor:
+  *     Red Hat, Inc. - initial API and implementation
+  ******************************************************************************/
+package org.hibernate.eclipse.console.actions;
+
+
+
+import org.eclipse.core.resources.IProject;
+import org.eclipse.core.runtime.CoreException;
+import org.eclipse.jdt.core.IJavaProject;
+import org.eclipse.jface.action.IAction;
+import org.eclipse.jface.viewers.ISelection;
+import org.eclipse.jface.viewers.TreePath;
+import org.eclipse.jface.viewers.TreeSelection;
+import org.eclipse.ui.IViewActionDelegate;
+import org.eclipse.ui.IViewPart;
+import org.hibernate.console.ConsoleConfiguration;
+import org.hibernate.eclipse.console.HibernateConsolePlugin;
+import org.hibernate.eclipse.nature.HibernateNature;
+
+/**
+ * @author Dmitry Geraskov
+ *
+ */
+
+public class OpenQueryEditorActionDelegate implements IViewActionDelegate {
+	
+	ISelection selection;
+
+	public OpenQueryEditorActionDelegate() {}
+
+	public void init(IViewPart view) {}
+
+	public void run(IAction action) {
+		ConsoleConfiguration config = getConfiguration();
+		if ("org.hibernate.eclipse.console.openHQLEditorAction".equals(action.getId())){//$NON-NLS-1$
+			HibernateConsolePlugin.getDefault().openScratchHQLEditor(config==null?null:config.getName(), "");//$NON-NLS-1$
+		} else if ("org.hibernate.eclipse.console.openCriEditorAction".equals(action.getId())){//$NON-NLS-1$
+			HibernateConsolePlugin.getDefault().openCriteriaEditor(config==null?null:config.getName(), "");//$NON-NLS-1$
+		}
+	}
+	
+	private ConsoleConfiguration getConfiguration() {
+		if (selection instanceof TreeSelection) {
+			TreeSelection sel = (TreeSelection) selection;
+			TreePath path = sel.getPaths()[0];
+			HibernateNature nature = null;
+			if (path.getFirstSegment() instanceof IProject) {
+				IProject project = (IProject) path.getFirstSegment();
+				try {
+					if (project.isOpen() && project.hasNature(HibernateNature.ID)){
+						nature = (HibernateNature) project.getNature(HibernateNature.ID);
+					}
+				} catch (CoreException e) {
+					HibernateConsolePlugin.getDefault().logErrorMessage(e.getMessage(), e);
+				}
+			} else if (path.getFirstSegment() instanceof IJavaProject) {
+				nature = HibernateNature.getHibernateNature( (IJavaProject) path.getFirstSegment() );
+			}	
+			if(nature != null) {
+				return nature.getDefaultConsoleConfiguration();
+			}
+		}
+		return null;		
+	}
+
+
+	public void selectionChanged(IAction action, ISelection selection) {
+		this.selection = selection;
+	}
+
+}

Property changes on: D:\workspaces\hibernate\org.hibernate.eclipse.console\src\org\hibernate\eclipse\console\actions\OpenQueryEditorActionDelegate.java
___________________________________________________________________
Name: svn:mime-type
   + text/plain
Name: svn:keywords
   + Author Id Revision Date
Name: svn:eol-style
   + native

Index: D:/workspaces/hibernate/org.hibernate.eclipse.console/plugin.xml
===================================================================
--- D:/workspaces/hibernate/org.hibernate.eclipse.console/plugin.xml	(revision 7514)
+++ D:/workspaces/hibernate/org.hibernate.eclipse.console/plugin.xml	(working copy)
@@ -113,6 +113,36 @@
                menubarPath="org.hibernate.eclipse.console.jtidymenu/group1"
                id="org.hibernate.eclipse.console.jtidyformat"/>
       </objectContribution>
+      <objectContribution
+            id="org.hibernate.eclipse.console.objectContribution1"
+            objectClass="org.eclipse.core.resources.IProject">
+      </objectContribution>
+      <viewerContribution
+            id="org.hibernate.eclipse.console.openQueryEditor"
+            targetID="org.eclipse.jdt.ui.PackageExplorer">
+         <menu
+               id="org.hibernate.eclipse.console.openQueryMenu"
+               label="Query Editors"
+               path="additions">
+            <groupMarker
+                  name="group1">
+            </groupMarker>
+         </menu>
+         <action
+               class="org.hibernate.eclipse.console.actions.OpenQueryEditorActionDelegate"
+               icon="icons/images/hql_editor.gif"
+               id="org.hibernate.eclipse.console.openHQLEditorAction"
+               label="Open HQL"
+               menubarPath="org.hibernate.eclipse.console.openQueryMenu/group1">
+         </action>
+         <action
+               class="org.hibernate.eclipse.console.actions.OpenQueryEditorActionDelegate"
+               icon="icons/images/criteria_editor.gif"
+               id="org.hibernate.eclipse.console.openCriEditorAction"
+               label="Open Criteria Editor"
+               menubarPath="org.hibernate.eclipse.console.openQueryMenu/group1">
+         </action>
+      </viewerContribution>
    </extension>
    <extension
          point="org.eclipse.ui.propertyPages">
